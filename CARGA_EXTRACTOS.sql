--TABLAS ORIGEN
SELECT * FROM ADSL
SELECT * FROM STB

-- Archivo ADSL
SELECT A,ZON,C_CIUDAD,MDF,AVERIA,CODSEG,inscripcio, CODEECC,CODLIQ,DDESCODLIQ,CODDETLIQ,DESCODDET,DGRUPO,ESTALIQ,OBSESTLIQ,DISTRITO,
FECHA_ADSL,FECHA_REG,FECHA_LIQU,MM_LIQ,AA_LIQ,JEF_CMR,USUALIQ,DTSERV,CODMOD,DESMODA,CTECNICO,SEG_OPE INTO ADSL FROM INDICA_ADSL_PAIS

--Archivo STB
SELECT cod_unico, Zonal,Distrito, Codseg, Mdf, Ti_liqn, Ti_liqn_de, Duracion, Mm_liq, Aa_liq, Gerencia, Jef_CMR, Eecc, Fecha_repo,
Fecha_liqu, Co_area_si, Co_usua_li, Fecha_alta  INTO STB FROM INDICA_STB_PAIS

--Archivo RCOBRE
SELECT * INTO RCOBRE_ADSL FROM REIT_SE
WHERE RE_FE_LIQU is not null and  TI_LIQN is not null and (DBO.TRIM(NEGOCIO)='STB' or DBO.TRIM(NEGOCIO)='ADSL')

SELECT * INTO RCOBRE_STB FROM REIT_SE
WHERE RE_FE_LIQU is not null and  TI_LIQN is not null and (DBO.TRIM(NEGOCIO)='STB' or DBO.TRIM(NEGOCIO)='ADSL')


-- Archivo ICOBRE

/*Consulta para crear la tabla ICOBRE*/
--declare @mes int =9;
SELECT *INTO ICOBRE FROM DET_ALTAS
WHERE MONTH(fejepex)= 9  AND TI_LIQN is not null and (NEGOCIO='STB' or NEGOCIO='ADSL')


--************************************************************************************************************************************
--************************************************************************************************************************************
--************************************************************************************************************************************
--************************************************************************************************************************************
-- CALCULOS---------------------------------------------------------------------------------------------------------------------------

--GLORIA
/*
ADSL_FINAL=23698,
STB_FINAL=21314,
REIT_ADSL=4729,
REIT_STB=2946
*/

--AP
/* 23/10/2019
ADSL_FINAL=23482,
STB_FINAL=21307,
REIT_ADSL=5387,
REIT_STB=3313
*/

--AP
/* 29/10/2019
ADSL_FINAL=23499,
STB_FINAL=21311,
REIT_ADSL=5390,
REIT_STB=3314
*/


SELECT COUNT(*) FILAS_ADSL_FINAL FROM ADSL_FINAL
SELECT COUNT(*) FILAS_STB_FINAL FROM STB_FINAL;
SELECT COUNT(*) FILAS_REIT_ADSL FROM REIT_ADSL;
SELECT COUNT(*) FILAS_REIT_STB FROM REIT_STB;


-- VERIFICAR
SELECT AVERIA FROM INDICA_ADSL_PAIS WHERE AVERIA IN(
'SAW1636506',	'SAW1642981',	'SAW1643058',	'SAW1644441',	'SAW1644879',	'SAW1645406',	'SAW1646844',	'SAW1647088',	'SAW1648093',	'SAW1649893',	'SAW1649904',	'SAW1650181',	'SAW1650207',	'SAW1650212',	'SAW1650312',	'SAW1650326',	'SAW1650342',	'SAW1650364',	'SAW1650365',	'SAW1650425',	'SAW1650440',	'SAW1650466',	'SAW1650517',	'SAW1650570',	'SAW1650967',	'SAW1651077',	'SAW1651162',	'SAW1651870',	'SAW1651879',	'SAW1651955',	'SAW1652218',	'SAW1652337',	'SAW1652390',	'SAW1653267',	'SAW1653316',	'SAW1653459',	'SAW1653641',	'SAW1653677',	'SAW1653897',	'SAW1654781',	'SAW1654868',	'SAW1654877',	'SAW1654885',	'SAW1654924',	'SAW1655204',	'SAW1655217',	'SAW1655247',	'SAW1655787',	'SAW1656046',	'SAW1656048',	'SAW1656670',	'SAW1656767',	'SAW1657024',	'SAW1659214',	'SAW1659216',	'SAW1659381',	'SAW1659646',	'SAW1659710',	'SAW1659753',	'SAW1659815',	'SAW1659851',	'SAW1659859',	'SAW1659862',	'SAW1659892',	'SAW1660172',	'SAW1660293',	'SAW1660951',	'SAW1661009',	'SAW1661066',	'SAW1661091',	'SAW1661284',	'SAW1661386',	'SAW1661558',	'SAW1661666',	'SAW1661793',	'SAW1661839',	'SAW1662214',	'SAW1662216',	'SAW1662217',	'SAW1662303',	'SAW1662332',	'SAW1662368',	'SAW1662442',	'SAW1662487',	'SAW1662489',	'SAW1662506',	'SAW1662535',	'SAW1662560',	'SAW1662705',	'SAW1662734',	'SAW1663568',	'SAW1663585',	'SAW1663651',	'SAW1663656',	'SAW1663674',	'SAW1663701',	'SAW1664261',	'SAW1664388',	'SAW1664474',	'SAW1665022',	'SAW1665137',	'SAW1665138',	'SAW1665456',	'SAW1665461',	'SAW1665464',	'SAW1665470',	'SAW1665525',	'SAW1665604',	'SAW1665707',	'SAW1665765',	'SAW1665973',	'SAW1667060',	'SAW1667542',	'SAW1667897',	'SAW1667954',	'SAW1668026',	'SAW1668037',	'SAW1668084',	'SAW1668326',	'SAW1668378',	'SAW1668485',	'SAW1668550',	'SAW1668682',	'SAW1668704',	'SAW1668855',	'SAW1668901',	'SAW1668904',	'SAW1669316',	'SAW1669340',	'SAW1669613',	'SAW1669777',	'SAW1669781',	'SAW1669844',	'SAW1670355',	'SAW1670428',	'SAW1670728',	'SAW1670729',	'SAW1670731',	'SAW1670951',	'SAW1670997',	'SAW1671189',	'SAW1671255',	'SAW1671339',	'SAW1671380',	'SAW1671785',	'SAW1671787',	'SAW1671847',	'SAW1671851',	'SAW1671979',	'SAW1671985',	'SAW1672008',	'SAW1672010',	'SAW1672028',	'SAW1672092',	'SAW1672140',	'SAW1672161',	'SAW1672167',	'SAW1672251',	'SAW1672371',	'SAW1672541',	'SAW1672750',	'SAW1672832',	'SAW1673196',	'SAW1673204',	'SAW1673426',	'SAW1673658',	'SAW1674068',	'SAW1674467',	'SAW1675846',	'SAW1675871',	'SAW1676158',	'SAW1676162',	'SAW1676204',	'SAW1676392',	'SAW1677674',	'SAW1677772',	'SAW1677775',	'SAW1677950',	'SAW1678037',	'SAW1678041',	'SAW1678805',	'SAW1678984',	'SAW1679282',	'SAW1679295',	'SAW1679298',	'SAW1681883',	'SAW1683151',	'SAW1683160',	'SAW1683162',	'SAW1683166',	'SAW1683366',	'SAW1686603',	'SAW1686606',	'SAW1686612',	'SAW1686621',	'SAW1686944',	'SAW1687316',	'SAW1687426',	'SAW1687715')

SELECT AVERIA FROM ADSL WHERE AVERIA IN(
'SAW1636506',	'SAW1642981',	'SAW1643058',	'SAW1644441',	'SAW1644879',	'SAW1645406',	'SAW1646844',	'SAW1647088',	'SAW1648093',	'SAW1649893',	'SAW1649904',	'SAW1650181',	'SAW1650207',	'SAW1650212',	'SAW1650312',	'SAW1650326',	'SAW1650342',	'SAW1650364',	'SAW1650365',	'SAW1650425',	'SAW1650440',	'SAW1650466',	'SAW1650517',	'SAW1650570',	'SAW1650967',	'SAW1651077',	'SAW1651162',	'SAW1651870',	'SAW1651879',	'SAW1651955',	'SAW1652218',	'SAW1652337',	'SAW1652390',	'SAW1653267',	'SAW1653316',	'SAW1653459',	'SAW1653641',	'SAW1653677',	'SAW1653897',	'SAW1654781',	'SAW1654868',	'SAW1654877',	'SAW1654885',	'SAW1654924',	'SAW1655204',	'SAW1655217',	'SAW1655247',	'SAW1655787',	'SAW1656046',	'SAW1656048',	'SAW1656670',	'SAW1656767',	'SAW1657024',	'SAW1659214',	'SAW1659216',	'SAW1659381',	'SAW1659646',	'SAW1659710',	'SAW1659753',	'SAW1659815',	'SAW1659851',	'SAW1659859',	'SAW1659862',	'SAW1659892',	'SAW1660172',	'SAW1660293',	'SAW1660951',	'SAW1661009',	'SAW1661066',	'SAW1661091',	'SAW1661284',	'SAW1661386',	'SAW1661558',	'SAW1661666',	'SAW1661793',	'SAW1661839',	'SAW1662214',	'SAW1662216',	'SAW1662217',	'SAW1662303',	'SAW1662332',	'SAW1662368',	'SAW1662442',	'SAW1662487',	'SAW1662489',	'SAW1662506',	'SAW1662535',	'SAW1662560',	'SAW1662705',	'SAW1662734',	'SAW1663568',	'SAW1663585',	'SAW1663651',	'SAW1663656',	'SAW1663674',	'SAW1663701',	'SAW1664261',	'SAW1664388',	'SAW1664474',	'SAW1665022',	'SAW1665137',	'SAW1665138',	'SAW1665456',	'SAW1665461',	'SAW1665464',	'SAW1665470',	'SAW1665525',	'SAW1665604',	'SAW1665707',	'SAW1665765',	'SAW1665973',	'SAW1667060',	'SAW1667542',	'SAW1667897',	'SAW1667954',	'SAW1668026',	'SAW1668037',	'SAW1668084',	'SAW1668326',	'SAW1668378',	'SAW1668485',	'SAW1668550',	'SAW1668682',	'SAW1668704',	'SAW1668855',	'SAW1668901',	'SAW1668904',	'SAW1669316',	'SAW1669340',	'SAW1669613',	'SAW1669777',	'SAW1669781',	'SAW1669844',	'SAW1670355',	'SAW1670428',	'SAW1670728',	'SAW1670729',	'SAW1670731',	'SAW1670951',	'SAW1670997',	'SAW1671189',	'SAW1671255',	'SAW1671339',	'SAW1671380',	'SAW1671785',	'SAW1671787',	'SAW1671847',	'SAW1671851',	'SAW1671979',	'SAW1671985',	'SAW1672008',	'SAW1672010',	'SAW1672028',	'SAW1672092',	'SAW1672140',	'SAW1672161',	'SAW1672167',	'SAW1672251',	'SAW1672371',	'SAW1672541',	'SAW1672750',	'SAW1672832',	'SAW1673196',	'SAW1673204',	'SAW1673426',	'SAW1673658',	'SAW1674068',	'SAW1674467',	'SAW1675846',	'SAW1675871',	'SAW1676158',	'SAW1676162',	'SAW1676204',	'SAW1676392',	'SAW1677674',	'SAW1677772',	'SAW1677775',	'SAW1677950',	'SAW1678037',	'SAW1678041',	'SAW1678805',	'SAW1678984',	'SAW1679282',	'SAW1679295',	'SAW1679298',	'SAW1681883',	'SAW1683151',	'SAW1683160',	'SAW1683162',	'SAW1683166',	'SAW1683366',	'SAW1686603',	'SAW1686606',	'SAW1686612',	'SAW1686621',	'SAW1686944',	'SAW1687316',	'SAW1687426',	'SAW1687715')

SELECT AVERIA FROM SMA_ADSL WHERE AVERIA IN(
'SAW1636506',	'SAW1642981',	'SAW1643058',	'SAW1644441',	'SAW1644879',	'SAW1645406',	'SAW1646844',	'SAW1647088',	'SAW1648093',	'SAW1649893',	'SAW1649904',	'SAW1650181',	'SAW1650207',	'SAW1650212',	'SAW1650312',	'SAW1650326',	'SAW1650342',	'SAW1650364',	'SAW1650365',	'SAW1650425',	'SAW1650440',	'SAW1650466',	'SAW1650517',	'SAW1650570',	'SAW1650967',	'SAW1651077',	'SAW1651162',	'SAW1651870',	'SAW1651879',	'SAW1651955',	'SAW1652218',	'SAW1652337',	'SAW1652390',	'SAW1653267',	'SAW1653316',	'SAW1653459',	'SAW1653641',	'SAW1653677',	'SAW1653897',	'SAW1654781',	'SAW1654868',	'SAW1654877',	'SAW1654885',	'SAW1654924',	'SAW1655204',	'SAW1655217',	'SAW1655247',	'SAW1655787',	'SAW1656046',	'SAW1656048',	'SAW1656670',	'SAW1656767',	'SAW1657024',	'SAW1659214',	'SAW1659216',	'SAW1659381',	'SAW1659646',	'SAW1659710',	'SAW1659753',	'SAW1659815',	'SAW1659851',	'SAW1659859',	'SAW1659862',	'SAW1659892',	'SAW1660172',	'SAW1660293',	'SAW1660951',	'SAW1661009',	'SAW1661066',	'SAW1661091',	'SAW1661284',	'SAW1661386',	'SAW1661558',	'SAW1661666',	'SAW1661793',	'SAW1661839',	'SAW1662214',	'SAW1662216',	'SAW1662217',	'SAW1662303',	'SAW1662332',	'SAW1662368',	'SAW1662442',	'SAW1662487',	'SAW1662489',	'SAW1662506',	'SAW1662535',	'SAW1662560',	'SAW1662705',	'SAW1662734',	'SAW1663568',	'SAW1663585',	'SAW1663651',	'SAW1663656',	'SAW1663674',	'SAW1663701',	'SAW1664261',	'SAW1664388',	'SAW1664474',	'SAW1665022',	'SAW1665137',	'SAW1665138',	'SAW1665456',	'SAW1665461',	'SAW1665464',	'SAW1665470',	'SAW1665525',	'SAW1665604',	'SAW1665707',	'SAW1665765',	'SAW1665973',	'SAW1667060',	'SAW1667542',	'SAW1667897',	'SAW1667954',	'SAW1668026',	'SAW1668037',	'SAW1668084',	'SAW1668326',	'SAW1668378',	'SAW1668485',	'SAW1668550',	'SAW1668682',	'SAW1668704',	'SAW1668855',	'SAW1668901',	'SAW1668904',	'SAW1669316',	'SAW1669340',	'SAW1669613',	'SAW1669777',	'SAW1669781',	'SAW1669844',	'SAW1670355',	'SAW1670428',	'SAW1670728',	'SAW1670729',	'SAW1670731',	'SAW1670951',	'SAW1670997',	'SAW1671189',	'SAW1671255',	'SAW1671339',	'SAW1671380',	'SAW1671785',	'SAW1671787',	'SAW1671847',	'SAW1671851',	'SAW1671979',	'SAW1671985',	'SAW1672008',	'SAW1672010',	'SAW1672028',	'SAW1672092',	'SAW1672140',	'SAW1672161',	'SAW1672167',	'SAW1672251',	'SAW1672371',	'SAW1672541',	'SAW1672750',	'SAW1672832',	'SAW1673196',	'SAW1673204',	'SAW1673426',	'SAW1673658',	'SAW1674068',	'SAW1674467',	'SAW1675846',	'SAW1675871',	'SAW1676158',	'SAW1676162',	'SAW1676204',	'SAW1676392',	'SAW1677674',	'SAW1677772',	'SAW1677775',	'SAW1677950',	'SAW1678037',	'SAW1678041',	'SAW1678805',	'SAW1678984',	'SAW1679282',	'SAW1679295',	'SAW1679298',	'SAW1681883',	'SAW1683151',	'SAW1683160',	'SAW1683162',	'SAW1683166',	'SAW1683366',	'SAW1686603',	'SAW1686606',	'SAW1686612',	'SAW1686621',	'SAW1686944',	'SAW1687316',	'SAW1687426',	'SAW1687715')


SELECT AVERIA FROM
(SELECT * FROM SMA_ADSL A WHERE DBO.TRIM(ESTALIQ) IN ('ZEI','STAR','RTNC','PEX','PAGE','VOIP') AND MODRUT=0
AND MODARM=0 AND INSMDF=0 AND TELEFONO='EFECTIVA' AND MM_LIQ = 9 AND AA_LIQ = 2019) A
WHERE AVERIA IN(
'SAW1636506',	'SAW1642981',	'SAW1643058',	'SAW1644441',	'SAW1644879',	'SAW1645406',	'SAW1646844',	'SAW1647088',	'SAW1648093',	'SAW1649893',	'SAW1649904',	'SAW1650181',	'SAW1650207',	'SAW1650212',	'SAW1650312',	'SAW1650326',	'SAW1650342',	'SAW1650364',	'SAW1650365',	'SAW1650425',	'SAW1650440',	'SAW1650466',	'SAW1650517',	'SAW1650570',	'SAW1650967',	'SAW1651077',	'SAW1651162',	'SAW1651870',	'SAW1651879',	'SAW1651955',	'SAW1652218',	'SAW1652337',	'SAW1652390',	'SAW1653267',	'SAW1653316',	'SAW1653459',	'SAW1653641',	'SAW1653677',	'SAW1653897',	'SAW1654781',	'SAW1654868',	'SAW1654877',	'SAW1654885',	'SAW1654924',	'SAW1655204',	'SAW1655217',	'SAW1655247',	'SAW1655787',	'SAW1656046',	'SAW1656048',	'SAW1656670',	'SAW1656767',	'SAW1657024',	'SAW1659214',	'SAW1659216',	'SAW1659381',	'SAW1659646',	'SAW1659710',	'SAW1659753',	'SAW1659815',	'SAW1659851',	'SAW1659859',	'SAW1659862',	'SAW1659892',	'SAW1660172',	'SAW1660293',	'SAW1660951',	'SAW1661009',	'SAW1661066',	'SAW1661091',	'SAW1661284',	'SAW1661386',	'SAW1661558',	'SAW1661666',	'SAW1661793',	'SAW1661839',	'SAW1662214',	'SAW1662216',	'SAW1662217',	'SAW1662303',	'SAW1662332',	'SAW1662368',	'SAW1662442',	'SAW1662487',	'SAW1662489',	'SAW1662506',	'SAW1662535',	'SAW1662560',	'SAW1662705',	'SAW1662734',	'SAW1663568',	'SAW1663585',	'SAW1663651',	'SAW1663656',	'SAW1663674',	'SAW1663701',	'SAW1664261',	'SAW1664388',	'SAW1664474',	'SAW1665022',	'SAW1665137',	'SAW1665138',	'SAW1665456',	'SAW1665461',	'SAW1665464',	'SAW1665470',	'SAW1665525',	'SAW1665604',	'SAW1665707',	'SAW1665765',	'SAW1665973',	'SAW1667060',	'SAW1667542',	'SAW1667897',	'SAW1667954',	'SAW1668026',	'SAW1668037',	'SAW1668084',	'SAW1668326',	'SAW1668378',	'SAW1668485',	'SAW1668550',	'SAW1668682',	'SAW1668704',	'SAW1668855',	'SAW1668901',	'SAW1668904',	'SAW1669316',	'SAW1669340',	'SAW1669613',	'SAW1669777',	'SAW1669781',	'SAW1669844',	'SAW1670355',	'SAW1670428',	'SAW1670728',	'SAW1670729',	'SAW1670731',	'SAW1670951',	'SAW1670997',	'SAW1671189',	'SAW1671255',	'SAW1671339',	'SAW1671380',	'SAW1671785',	'SAW1671787',	'SAW1671847',	'SAW1671851',	'SAW1671979',	'SAW1671985',	'SAW1672008',	'SAW1672010',	'SAW1672028',	'SAW1672092',	'SAW1672140',	'SAW1672161',	'SAW1672167',	'SAW1672251',	'SAW1672371',	'SAW1672541',	'SAW1672750',	'SAW1672832',	'SAW1673196',	'SAW1673204',	'SAW1673426',	'SAW1673658',	'SAW1674068',	'SAW1674467',	'SAW1675846',	'SAW1675871',	'SAW1676158',	'SAW1676162',	'SAW1676204',	'SAW1676392',	'SAW1677674',	'SAW1677772',	'SAW1677775',	'SAW1677950',	'SAW1678037',	'SAW1678041',	'SAW1678805',	'SAW1678984',	'SAW1679282',	'SAW1679295',	'SAW1679298',	'SAW1681883',	'SAW1683151',	'SAW1683160',	'SAW1683162',	'SAW1683166',	'SAW1683366',	'SAW1686603',	'SAW1686606',	'SAW1686612',	'SAW1686621',	'SAW1686944',	'SAW1687316',	'SAW1687426',	'SAW1687715')


SELECT AVERIA FROM
(SELECT * FROM SMA_ADSL A WHERE DBO.TRIM(ESTALIQ) IN ('ZEI','STAR','RTNC','PEX','PAGE','VOIP') AND MODRUT=0
AND MODARM=0 AND INSMDF=0) A
WHERE AVERIA IN(
'SAW1636506',	'SAW1642981',	'SAW1643058',	'SAW1644441',	'SAW1644879',	'SAW1645406',	'SAW1646844',	'SAW1647088',	'SAW1648093',	'SAW1649893',	'SAW1649904',	'SAW1650181',	'SAW1650207',	'SAW1650212',	'SAW1650312',	'SAW1650326',	'SAW1650342',	'SAW1650364',	'SAW1650365',	'SAW1650425',	'SAW1650440',	'SAW1650466',	'SAW1650517',	'SAW1650570',	'SAW1650967',	'SAW1651077',	'SAW1651162',	'SAW1651870',	'SAW1651879',	'SAW1651955',	'SAW1652218',	'SAW1652337',	'SAW1652390',	'SAW1653267',	'SAW1653316',	'SAW1653459',	'SAW1653641',	'SAW1653677',	'SAW1653897',	'SAW1654781',	'SAW1654868',	'SAW1654877',	'SAW1654885',	'SAW1654924',	'SAW1655204',	'SAW1655217',	'SAW1655247',	'SAW1655787',	'SAW1656046',	'SAW1656048',	'SAW1656670',	'SAW1656767',	'SAW1657024',	'SAW1659214',	'SAW1659216',	'SAW1659381',	'SAW1659646',	'SAW1659710',	'SAW1659753',	'SAW1659815',	'SAW1659851',	'SAW1659859',	'SAW1659862',	'SAW1659892',	'SAW1660172',	'SAW1660293',	'SAW1660951',	'SAW1661009',	'SAW1661066',	'SAW1661091',	'SAW1661284',	'SAW1661386',	'SAW1661558',	'SAW1661666',	'SAW1661793',	'SAW1661839',	'SAW1662214',	'SAW1662216',	'SAW1662217',	'SAW1662303',	'SAW1662332',	'SAW1662368',	'SAW1662442',	'SAW1662487',	'SAW1662489',	'SAW1662506',	'SAW1662535',	'SAW1662560',	'SAW1662705',	'SAW1662734',	'SAW1663568',	'SAW1663585',	'SAW1663651',	'SAW1663656',	'SAW1663674',	'SAW1663701',	'SAW1664261',	'SAW1664388',	'SAW1664474',	'SAW1665022',	'SAW1665137',	'SAW1665138',	'SAW1665456',	'SAW1665461',	'SAW1665464',	'SAW1665470',	'SAW1665525',	'SAW1665604',	'SAW1665707',	'SAW1665765',	'SAW1665973',	'SAW1667060',	'SAW1667542',	'SAW1667897',	'SAW1667954',	'SAW1668026',	'SAW1668037',	'SAW1668084',	'SAW1668326',	'SAW1668378',	'SAW1668485',	'SAW1668550',	'SAW1668682',	'SAW1668704',	'SAW1668855',	'SAW1668901',	'SAW1668904',	'SAW1669316',	'SAW1669340',	'SAW1669613',	'SAW1669777',	'SAW1669781',	'SAW1669844',	'SAW1670355',	'SAW1670428',	'SAW1670728',	'SAW1670729',	'SAW1670731',	'SAW1670951',	'SAW1670997',	'SAW1671189',	'SAW1671255',	'SAW1671339',	'SAW1671380',	'SAW1671785',	'SAW1671787',	'SAW1671847',	'SAW1671851',	'SAW1671979',	'SAW1671985',	'SAW1672008',	'SAW1672010',	'SAW1672028',	'SAW1672092',	'SAW1672140',	'SAW1672161',	'SAW1672167',	'SAW1672251',	'SAW1672371',	'SAW1672541',	'SAW1672750',	'SAW1672832',	'SAW1673196',	'SAW1673204',	'SAW1673426',	'SAW1673658',	'SAW1674068',	'SAW1674467',	'SAW1675846',	'SAW1675871',	'SAW1676158',	'SAW1676162',	'SAW1676204',	'SAW1676392',	'SAW1677674',	'SAW1677772',	'SAW1677775',	'SAW1677950',	'SAW1678037',	'SAW1678041',	'SAW1678805',	'SAW1678984',	'SAW1679282',	'SAW1679295',	'SAW1679298',	'SAW1681883',	'SAW1683151',	'SAW1683160',	'SAW1683162',	'SAW1683166',	'SAW1683366',	'SAW1686603',	'SAW1686606',	'SAW1686612',	'SAW1686621',	'SAW1686944',	'SAW1687316',	'SAW1687426',	'SAW1687715')

----------------------------------------------------------------------------------------------
-- NO PASAN LAS 199 FILAS PORQUE TIENEN EL MODRUT EN 1,
SELECT A.AVERIA, A.TELEFONO, A.MODRUT, A.MODARM, A.INSMDF, A.ZON, A.CSEG, A.MDF, B.MDF FROM SMA_ADSL A JOIN RUTEMPP B ON A.MDF = B.MDF
WHERE A.AVERIA IN (
'SAW1636506',	'SAW1642981',	'SAW1643058',	'SAW1644441',	'SAW1644879',	'SAW1645406',	'SAW1646844',	'SAW1647088',	'SAW1648093',	'SAW1649893',	'SAW1649904',	'SAW1650181',	'SAW1650207',	'SAW1650212',	'SAW1650312',	'SAW1650326',	'SAW1650342',	'SAW1650364',	'SAW1650365',	'SAW1650425',	'SAW1650440',	'SAW1650466',	'SAW1650517',	'SAW1650570',	'SAW1650967',	'SAW1651077',	'SAW1651162',	'SAW1651870',	'SAW1651879',	'SAW1651955',	'SAW1652218',	'SAW1652337',	'SAW1652390',	'SAW1653267',	'SAW1653316',	'SAW1653459',	'SAW1653641',	'SAW1653677',	'SAW1653897',	'SAW1654781',	'SAW1654868',	'SAW1654877',	'SAW1654885',	'SAW1654924',	'SAW1655204',	'SAW1655217',	'SAW1655247',	'SAW1655787',	'SAW1656046',	'SAW1656048',	'SAW1656670',	'SAW1656767',	'SAW1657024',	'SAW1659214',	'SAW1659216',	'SAW1659381',	'SAW1659646',	'SAW1659710',	'SAW1659753',	'SAW1659815',	'SAW1659851',	'SAW1659859',	'SAW1659862',	'SAW1659892',	'SAW1660172',	'SAW1660293',	'SAW1660951',	'SAW1661009',	'SAW1661066',	'SAW1661091',	'SAW1661284',	'SAW1661386',	'SAW1661558',	'SAW1661666',	'SAW1661793',	'SAW1661839',	'SAW1662214',	'SAW1662216',	'SAW1662217',	'SAW1662303',	'SAW1662332',	'SAW1662368',	'SAW1662442',	'SAW1662487',	'SAW1662489',	'SAW1662506',	'SAW1662535',	'SAW1662560',	'SAW1662705',	'SAW1662734',	'SAW1663568',	'SAW1663585',	'SAW1663651',	'SAW1663656',	'SAW1663674',	'SAW1663701',	'SAW1664261',	'SAW1664388',	'SAW1664474',	'SAW1665022',	'SAW1665137',	'SAW1665138',	'SAW1665456',	'SAW1665461',	'SAW1665464',	'SAW1665470',	'SAW1665525',	'SAW1665604',	'SAW1665707',	'SAW1665765',	'SAW1665973',	'SAW1667060',	'SAW1667542',	'SAW1667897',	'SAW1667954',	'SAW1668026',	'SAW1668037',	'SAW1668084',	'SAW1668326',	'SAW1668378',	'SAW1668485',	'SAW1668550',	'SAW1668682',	'SAW1668704',	'SAW1668855',	'SAW1668901',	'SAW1668904',	'SAW1669316',	'SAW1669340',	'SAW1669613',	'SAW1669777',	'SAW1669781',	'SAW1669844',	'SAW1670355',	'SAW1670428',	'SAW1670728',	'SAW1670729',	'SAW1670731',	'SAW1670951',	'SAW1670997',	'SAW1671189',	'SAW1671255',	'SAW1671339',	'SAW1671380',	'SAW1671785',	'SAW1671787',	'SAW1671847',	'SAW1671851',	'SAW1671979',	'SAW1671985',	'SAW1672008',	'SAW1672010',	'SAW1672028',	'SAW1672092',	'SAW1672140',	'SAW1672161',	'SAW1672167',	'SAW1672251',	'SAW1672371',	'SAW1672541',	'SAW1672750',	'SAW1672832',	'SAW1673196',	'SAW1673204',	'SAW1673426',	'SAW1673658',	'SAW1674068',	'SAW1674467',	'SAW1675846',	'SAW1675871',	'SAW1676158',	'SAW1676162',	'SAW1676204',	'SAW1676392',	'SAW1677674',	'SAW1677772',	'SAW1677775',	'SAW1677950',	'SAW1678037',	'SAW1678041',	'SAW1678805',	'SAW1678984',	'SAW1679282',	'SAW1679295',	'SAW1679298',	'SAW1681883',	'SAW1683151',	'SAW1683160',	'SAW1683162',	'SAW1683166',	'SAW1683366',	'SAW1686603',	'SAW1686606',	'SAW1686612',	'SAW1686621',	'SAW1686944',	'SAW1687316',	'SAW1687426',	'SAW1687715')
AND DBO.TRIM(A.ESTALIQ) IN ('ZEI','STAR','RTNC','PEX','PAGE','VOIP') AND LEN(DBO.TRIM(A.MDF)) = 4 AND A.CSEG = 'E'




--*****************************************************************
-- NO PASAN LAS 199 FILAS PORQUE TIENEN EL MODRUT EN 1
SELECT AVERIA, TELEFONO, MODRUT, MODARM, INSMDF, ZON, CSEG FROM SMA_ADSL
WHERE AVERIA IN (
'SAW1636506',	'SAW1642981',	'SAW1643058',	'SAW1644441',	'SAW1644879',	'SAW1645406',	'SAW1646844',	'SAW1647088',	'SAW1648093',	'SAW1649893',	'SAW1649904',	'SAW1650181',	'SAW1650207',	'SAW1650212',	'SAW1650312',	'SAW1650326',	'SAW1650342',	'SAW1650364',	'SAW1650365',	'SAW1650425',	'SAW1650440',	'SAW1650466',	'SAW1650517',	'SAW1650570',	'SAW1650967',	'SAW1651077',	'SAW1651162',	'SAW1651870',	'SAW1651879',	'SAW1651955',	'SAW1652218',	'SAW1652337',	'SAW1652390',	'SAW1653267',	'SAW1653316',	'SAW1653459',	'SAW1653641',	'SAW1653677',	'SAW1653897',	'SAW1654781',	'SAW1654868',	'SAW1654877',	'SAW1654885',	'SAW1654924',	'SAW1655204',	'SAW1655217',	'SAW1655247',	'SAW1655787',	'SAW1656046',	'SAW1656048',	'SAW1656670',	'SAW1656767',	'SAW1657024',	'SAW1659214',	'SAW1659216',	'SAW1659381',	'SAW1659646',	'SAW1659710',	'SAW1659753',	'SAW1659815',	'SAW1659851',	'SAW1659859',	'SAW1659862',	'SAW1659892',	'SAW1660172',	'SAW1660293',	'SAW1660951',	'SAW1661009',	'SAW1661066',	'SAW1661091',	'SAW1661284',	'SAW1661386',	'SAW1661558',	'SAW1661666',	'SAW1661793',	'SAW1661839',	'SAW1662214',	'SAW1662216',	'SAW1662217',	'SAW1662303',	'SAW1662332',	'SAW1662368',	'SAW1662442',	'SAW1662487',	'SAW1662489',	'SAW1662506',	'SAW1662535',	'SAW1662560',	'SAW1662705',	'SAW1662734',	'SAW1663568',	'SAW1663585',	'SAW1663651',	'SAW1663656',	'SAW1663674',	'SAW1663701',	'SAW1664261',	'SAW1664388',	'SAW1664474',	'SAW1665022',	'SAW1665137',	'SAW1665138',	'SAW1665456',	'SAW1665461',	'SAW1665464',	'SAW1665470',	'SAW1665525',	'SAW1665604',	'SAW1665707',	'SAW1665765',	'SAW1665973',	'SAW1667060',	'SAW1667542',	'SAW1667897',	'SAW1667954',	'SAW1668026',	'SAW1668037',	'SAW1668084',	'SAW1668326',	'SAW1668378',	'SAW1668485',	'SAW1668550',	'SAW1668682',	'SAW1668704',	'SAW1668855',	'SAW1668901',	'SAW1668904',	'SAW1669316',	'SAW1669340',	'SAW1669613',	'SAW1669777',	'SAW1669781',	'SAW1669844',	'SAW1670355',	'SAW1670428',	'SAW1670728',	'SAW1670729',	'SAW1670731',	'SAW1670951',	'SAW1670997',	'SAW1671189',	'SAW1671255',	'SAW1671339',	'SAW1671380',	'SAW1671785',	'SAW1671787',	'SAW1671847',	'SAW1671851',	'SAW1671979',	'SAW1671985',	'SAW1672008',	'SAW1672010',	'SAW1672028',	'SAW1672092',	'SAW1672140',	'SAW1672161',	'SAW1672167',	'SAW1672251',	'SAW1672371',	'SAW1672541',	'SAW1672750',	'SAW1672832',	'SAW1673196',	'SAW1673204',	'SAW1673426',	'SAW1673658',	'SAW1674068',	'SAW1674467',	'SAW1675846',	'SAW1675871',	'SAW1676158',	'SAW1676162',	'SAW1676204',	'SAW1676392',	'SAW1677674',	'SAW1677772',	'SAW1677775',	'SAW1677950',	'SAW1678037',	'SAW1678041',	'SAW1678805',	'SAW1678984',	'SAW1679282',	'SAW1679295',	'SAW1679298',	'SAW1681883',	'SAW1683151',	'SAW1683160',	'SAW1683162',	'SAW1683166',	'SAW1683366',	'SAW1686603',	'SAW1686606',	'SAW1686612',	'SAW1686621',	'SAW1686944',	'SAW1687316',	'SAW1687426',	'SAW1687715')
AND DBO.TRIM(ESTALIQ) IN ('ZEI','STAR','RTNC','PEX','PAGE','VOIP')

--------------------------------------
UPDATE SMA_ADSL
SET MODRUT = 0
WHERE  AVERIA IN (
'SAW1636506',	'SAW1642981',	'SAW1643058',	'SAW1644441',	'SAW1644879',	'SAW1645406',	'SAW1646844',	'SAW1647088',	'SAW1648093',	'SAW1649893',	'SAW1649904',	'SAW1650181',	'SAW1650207',	'SAW1650212',	'SAW1650312',	'SAW1650326',	'SAW1650342',	'SAW1650364',	'SAW1650365',	'SAW1650425',	'SAW1650440',	'SAW1650466',	'SAW1650517',	'SAW1650570',	'SAW1650967',	'SAW1651077',	'SAW1651162',	'SAW1651870',	'SAW1651879',	'SAW1651955',	'SAW1652218',	'SAW1652337',	'SAW1652390',	'SAW1653267',	'SAW1653316',	'SAW1653459',	'SAW1653641',	'SAW1653677',	'SAW1653897',	'SAW1654781',	'SAW1654868',	'SAW1654877',	'SAW1654885',	'SAW1654924',	'SAW1655204',	'SAW1655217',	'SAW1655247',	'SAW1655787',	'SAW1656046',	'SAW1656048',	'SAW1656670',	'SAW1656767',	'SAW1657024',	'SAW1659214',	'SAW1659216',	'SAW1659381',	'SAW1659646',	'SAW1659710',	'SAW1659753',	'SAW1659815',	'SAW1659851',	'SAW1659859',	'SAW1659862',	'SAW1659892',	'SAW1660172',	'SAW1660293',	'SAW1660951',	'SAW1661009',	'SAW1661066',	'SAW1661091',	'SAW1661284',	'SAW1661386',	'SAW1661558',	'SAW1661666',	'SAW1661793',	'SAW1661839',	'SAW1662214',	'SAW1662216',	'SAW1662217',	'SAW1662303',	'SAW1662332',	'SAW1662368',	'SAW1662442',	'SAW1662487',	'SAW1662489',	'SAW1662506',	'SAW1662535',	'SAW1662560',	'SAW1662705',	'SAW1662734',	'SAW1663568',	'SAW1663585',	'SAW1663651',	'SAW1663656',	'SAW1663674',	'SAW1663701',	'SAW1664261',	'SAW1664388',	'SAW1664474',	'SAW1665022',	'SAW1665137',	'SAW1665138',	'SAW1665456',	'SAW1665461',	'SAW1665464',	'SAW1665470',	'SAW1665525',	'SAW1665604',	'SAW1665707',	'SAW1665765',	'SAW1665973',	'SAW1667060',	'SAW1667542',	'SAW1667897',	'SAW1667954',	'SAW1668026',	'SAW1668037',	'SAW1668084',	'SAW1668326',	'SAW1668378',	'SAW1668485',	'SAW1668550',	'SAW1668682',	'SAW1668704',	'SAW1668855',	'SAW1668901',	'SAW1668904',	'SAW1669316',	'SAW1669340',	'SAW1669613',	'SAW1669777',	'SAW1669781',	'SAW1669844',	'SAW1670355',	'SAW1670428',	'SAW1670728',	'SAW1670729',	'SAW1670731',	'SAW1670951',	'SAW1670997',	'SAW1671189',	'SAW1671255',	'SAW1671339',	'SAW1671380',	'SAW1671785',	'SAW1671787',	'SAW1671847',	'SAW1671851',	'SAW1671979',	'SAW1671985',	'SAW1672008',	'SAW1672010',	'SAW1672028',	'SAW1672092',	'SAW1672140',	'SAW1672161',	'SAW1672167',	'SAW1672251',	'SAW1672371',	'SAW1672541',	'SAW1672750',	'SAW1672832',	'SAW1673196',	'SAW1673204',	'SAW1673426',	'SAW1673658',	'SAW1674068',	'SAW1674467',	'SAW1675846',	'SAW1675871',	'SAW1676158',	'SAW1676162',	'SAW1676204',	'SAW1676392',	'SAW1677674',	'SAW1677772',	'SAW1677775',	'SAW1677950',	'SAW1678037',	'SAW1678041',	'SAW1678805',	'SAW1678984',	'SAW1679282',	'SAW1679295',	'SAW1679298',	'SAW1681883',	'SAW1683151',	'SAW1683160',	'SAW1683162',	'SAW1683166',	'SAW1683366',	'SAW1686603',	'SAW1686606',	'SAW1686612',	'SAW1686621',	'SAW1686944',	'SAW1687316',	'SAW1687426',	'SAW1687715')

-------------------------------------------------------------------------------------------------------------------------------



SELECT * FROM STB WHERE COD_UNICO IN ('BAR0146739','BAV0593074','BAV0599679')
SELECT * FROM SMA_STB WHERE COD_UNICO IN ('BAR0146739','BAV0593074','BAV0599679')

UPDATE SMA_STB
SET MODRUTAS = 0
WHERE COD_UNICO IN ('BAR0146739','BAV0593074','BAV0599679')


-- NO PASAN ESTAS 3 FILAS PORQUE TIENEN MODRUT = 1-------------------------------------------------------------------------------------------------------------------------
SELECT COD_UNICO, MODRUTAS, INS_MDF, MODARM, CLASIF FROM SMA_STB WHERE COD_UNICO IN ('BAR0146739','BAV0593074','BAV0599679') AND SUBSTRING(COD_UNICO,1,2)<>'RU'

SELECT A.COD_UNICO, A.MODRUTAS, A.INS_MDF, A.MODARM, A.CLASIF, A.MDF, B.MDF FROM SMA_STB A JOIN MODARM B ON A.MDF = B.MDF AND  DBO.TRIM(A.TI_LIQN) IN ('15', '24')
AND COD_UNICO IN ('BAR0146739','BAV0593074','BAV0599679')

SELECT COD_UNICO, MODRUTAS, INS_MDF, MODARM, CLASIF FROM SMA_STB WHERE COD_UNICO IN ('BAR0146739','BAV0593074','BAV0599679') AND DBO.TRIM(ZONAL) = 'LIMA' AND CSEG = 'E'
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------

UPDATE SMA_STB
SET MODRUTAS = 1
WHERE DBO.TRIM(ZONAL) = 'LIMA' AND CSEG = 'E' AND MM_LIQ = @MES;

UPDATE A
SET MODARM = 1
FROM SMA_STB A JOIN MODARM B ON A.MDF = B.MDF
WHERE  DBO.TRIM(A.TI_LIQN) IN ('15', '24')
	  AND A.MM_LIQ = @MES
	  AND A.AA_LIQ = @ANIO;


SELECT * INTO STB_FINAL FROM (SELECT * FROM SMA_STB A
WHERE MODRUTAS=0 AND INS_MDF=0 AND MODARM=0 AND DBO.TRIM(CLASIF)='EFECTIVA' AND SUBSTRING(COD_UNICO,1,2)<>'RU') A

--*******************************************************************************************************************************************************************
-- CREANDO LA TABLA REIT_STB
SELECT * INTO REIT_STB FROM RCOBRE_STB WHERE DBO.TRIM(NEGOCIO) = 'STB' AND MONTH(FE_LIQU) = '09' AND DBO.TRIM(RESULT) = '1'
AND RE_FE_REPO - FE_LIQU >= 0  AND RE_FE_REPO - FE_LIQU <= 30 AND MODRUTAS = '0' AND MODARM = '0' AND INSMDF = '0'

SELECT * FROM RCOBRE_STB WHERE DBO.TRIM(NEGOCIO) = 'STB' AND MONTH(FE_LIQU) = '09'

---------------------------*************************************************************************************

-- LOS 661 CODAVERIA DE AP QUE NO ESTAN EN REIT_ADSL_GLORIA
SELECT CODAVERIA FROM REIT_ADSL WHERE CODAVERIA NOT IN
(SELECT A.CODAVERIA FROM REIT_ADSL A JOIN REIT_ADSL_GLORIA B ON A.CODAVERIA = B.CODAVERIA)
--------------------------------------------------------------------------------
SELECT A.CODAVERIA, B.CODAVERIA FROM REIT_ADSL A JOIN REIT_ADSL_GLORIA B ON A.CODAVERIA = B.CODAVERIA


SELECT * FROM RCOBRE_ADSL WHERE CODAVERIA IN
(SELECT CODAVERIA FROM REIT_ADSL WHERE CODAVERIA NOT IN
(SELECT A.CODAVERIA FROM REIT_ADSL A JOIN REIT_ADSL_GLORIA B ON A.CODAVERIA = B.CODAVERIA) )

SELECT * FROM REIT_ADSL WHERE CODAVERIA IN
(SELECT CODAVERIA FROM REIT_ADSL WHERE CODAVERIA NOT IN
(SELECT A.CODAVERIA FROM REIT_ADSL A JOIN REIT_ADSL_GLORIA B ON A.CODAVERIA = B.CODAVERIA) )

SELECT * INTO REIT_ADSL FROM RCOBRE_ADSL WHERE DBO.TRIM(NEGOCIO) = 'ADSL' AND MONTH(FE_LIQU) = '9' AND DBO.TRIM(RESULT) = '1' AND RE_FE_REPO - FE_LIQU >= 0
AND RE_FE_REPO - FE_LIQU <= 30 AND MODRUTAS = '0' AND MODARM = '0' AND INSMDF = '0'
AND AREALIQ IN ('ZEI','STAR','RTNC','PEX','VOIP','PAGE') AND RE_AREALIQ IN ('ZEI','STAR','RTNC','PEX','VOIP','PAGE')



SELECT A.CODAVERIA, NEGOCIO, ZON, MONTH(FE_LIQU), RESULT, (RE_FE_REPO), (FE_LIQU), DAY(RE_FE_REPO - FE_LIQU)-1 AS DIAS, MODRUTAS, MODARM, INSMDF, AREALIQ, RE_AREALIQ  FROM (
SELECT CODAVERIA FROM REIT_ADSL WHERE CODAVERIA NOT IN
(SELECT A.CODAVERIA FROM REIT_ADSL A JOIN REIT_ADSL_GLORIA B ON A.CODAVERIA = B.CODAVERIA)) A JOIN RCOBRE_ADSL B ON A.CODAVERIA = B.CODAVERIA
WHERE DBO.TRIM(NEGOCIO) = 'ADSL' AND MONTH(FE_LIQU) = '9' AND DBO.TRIM(RESULT) = '1' AND DAY(RE_FE_REPO - FE_LIQU)-1 >= 0
AND DAY(RE_FE_REPO - FE_LIQU)-1 <= 30 AND MODRUTAS = '0' AND MODARM = '0' AND INSMDF = '0'
AND AREALIQ IN ('ZEI','STAR','RTNC','PEX','VOIP','PAGE') AND RE_AREALIQ IN ('ZEI','STAR','RTNC','PEX','VOIP','PAGE')
ORDER BY RE_FE_REPO DESC

-- QUERY ANALISIS REIT_ADSL
SELECT A.CODAVERIA, CO_MDF, NEGOCIO, ZON, CODSEG, TI_LIQN, MONTH(FE_LIQU), RESULT, (RE_FE_REPO), (FE_LIQU), DATEDIFF(DAY, FE_LIQU,  RE_FE_REPO) AS DIAS , MODRUTAS, MODARM, INSMDF, AREALIQ, RE_AREALIQ  FROM (
SELECT CODAVERIA FROM REIT_ADSL WHERE CODAVERIA NOT IN
(SELECT A.CODAVERIA FROM REIT_ADSL A JOIN REIT_ADSL_GLORIA B ON A.CODAVERIA = B.CODAVERIA)) A JOIN RCOBRE_ADSL B ON A.CODAVERIA = B.CODAVERIA
WHERE DBO.TRIM(NEGOCIO) = 'ADSL' AND MONTH(FE_LIQU) = '9' AND DBO.TRIM(RESULT) = '1' AND DATEDIFF(DAY, FE_LIQU,  RE_FE_REPO) >= 0
AND DATEDIFF(DAY, FE_LIQU,  RE_FE_REPO) <= 30 AND MODRUTAS = '0' AND MODARM = '0' AND INSMDF = '0'
AND AREALIQ IN ('ZEI','STAR','RTNC','PEX','VOIP','PAGE') AND RE_AREALIQ IN ('ZEI','STAR','RTNC','PEX','VOIP','PAGE')
ORDER BY TI_LIQN DESC


-- ANALISIS CON JOIN ----- TEST

SELECT A.CODAVERIA, CO_MDF, NEGOCIO, ZON, CODSEG, TI_LIQN, MONTH(FE_LIQU), RESULT, (RE_FE_REPO), (FE_LIQU), DATEDIFF(DAY, FE_LIQU,  RE_FE_REPO) AS DIAS , MODRUTAS, MODARM, INSMDF, AREALIQ, RE_AREALIQ  FROM (
SELECT CODAVERIA FROM REIT_ADSL A JOIN RUTEMPP B ON A.CO_MDF = B.MDF
WHERE CODAVERIA NOT IN
(SELECT A.CODAVERIA FROM REIT_ADSL A JOIN REIT_ADSL_GLORIA B ON A.CODAVERIA = B.CODAVERIA)) A JOIN RCOBRE_ADSL B ON A.CODAVERIA = B.CODAVERIA
WHERE DBO.TRIM(NEGOCIO) = 'ADSL' AND MONTH(FE_LIQU) = '9' AND DBO.TRIM(RESULT) = '1' AND DATEDIFF(DAY, FE_LIQU,  RE_FE_REPO) >= 0
AND DATEDIFF(DAY, FE_LIQU,  RE_FE_REPO) <= 30 AND MODRUTAS = '0' AND MODARM = '0' AND INSMDF = '0'
AND AREALIQ IN ('ZEI','STAR','RTNC','PEX','VOIP','PAGE') AND RE_AREALIQ IN ('ZEI','STAR','RTNC','PEX','VOIP','PAGE')
AND DBO.TRIM(ZON) <> 'LIM'
    AND DBO.TRIM(CODSEG) IN ('0','00','1','01','2','02','3','03','4','04','5','05','6','06','7','07')


FROM RCOBRE_ADSL A JOIN RUTEMPP B ON A.CO_MDF = B.MDF
WHERE DBO.TRIM(A.ZON) <> 'LIM'
    AND DBO.TRIM(A.CODSEG) IN ('0','00','1','01','2','02','3','03','4','04','5','05','6','06','7','07')
------------------------------------------------------------------------------------------------------------------------------------------------------------------

SELECT CODAVERIA, NEGOCIO, ZON, CODSEG, TI_LIQN, MONTH(FE_LIQU), RESULT, (RE_FE_REPO), (FE_LIQU), DATEDIFF(DAY, FE_LIQU,  RE_FE_REPO) AS DIAS , MODRUTAS, MODARM, INSMDF, AREALIQ, RE_AREALIQ FROM REIT_ADSL WHERE DBO.TRIM(ZON) <> 'LIM'
    AND DBO.TRIM(CODSEG) IN ('0','00','1','01','2','02','3','03','4','04','5','05','6','06','7','07')
 AND CODAVERIA IN (SELECT CODAVERIA FROM REIT_ADSL WHERE CODAVERIA NOT IN
(SELECT A.CODAVERIA FROM REIT_ADSL A JOIN REIT_ADSL_GLORIA B ON A.CODAVERIA = B.CODAVERIA) )


UPDATE A
SET A.MODRUTAS = 'X'
FROM RCOBRE_ADSL A JOIN RUTEMPP B ON A.CO_MDF = B.MDF
WHERE DBO.TRIM(A.ZON) <> 'LIM'
    AND DBO.TRIM(A.CODSEG) IN ('0','00','1','01','2','02','3','03','4','04','5','05','6','06','7','07')

UPDATE A
SET A.MODARM = 'X'
FROM RCOBRE_ADSL A JOIN MODARM B ON A.CO_MDF = B.MDF
WHERE DBO.TRIM(A.ZON) = 'LIM'
    AND DBO.TRIM(A.TI_LIQN) IN ('15','24'








SELECT TOP 1 CODAVERIA, NEGOCIO, MONTH(FE_LIQU), RESULT, (RE_FE_REPO), (FE_LIQU), DATEDIFF(DAY, FE_LIQU,  RE_FE_REPO) AS DIAS , MODRUTAS, MODARM,
INSMDF, AREALIQ, RE_AREALIQ  FROM REIT_ADSL_GLORIA ORDER BY DIAS DESC;


SELECT DATEDIFF(DAY, RE_FE_REPO, FE_LIQU) AS DIAS;

SELECT CODAVERIA, NEGOCIO, MONTH(FE_LIQU), RESULT, RE_FE_REPO, FE_LIQU, DAY(RE_FE_REPO - FE_LIQU)-1 AS DIAS, MODRUTAS, MODARM, INSMDF, AREALIQ,
RE_AREALIQ  FROM REIT_ADSL_GLORIA ORDER BY DIAS DESC
